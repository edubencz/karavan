- route:
    id: route-cobranca-unicred
    nodePrefixId: route-ecf
    from:
      id: from-route-cobranca-unicred
      uri: direct
      parameters:
        name: route-cobranca-unicred
      steps:
        - log:
            id: log-920c
            description: "# ROUTE Unicred COBRANCA #"
            message: "# ROUTE Unicred COBRANCA #"
        - choice:
            id: choice-2a4b
            when:
              - id: when-dbec
                description: Registrar
                expression:
                  simple:
                    id: simple-1d38
                    expression: ${exchangeProperty.rota[tipo]} == 'registrar'
                steps:
                  - doTry:
                      id: doTry-6908
                      doCatch:
                        - id: doCatch-32e3
                          exception:
                            - java.lang.Exception
                          steps:
                            - setHeader:
                                id: setHeader-9e0c
                                disabled: true
                                name: CamelHttpResponseCode
                                expression:
                                  simple:
                                    id: simple-e5d0
                                    expression: "400"
                            - setProperty:
                                id: setProperty-806e
                                description: "Var: errorRoute"
                                name: errorRoute
                                expression:
                                  simple:
                                    id: simple-e10c
                                    expression: >-
                                      "informativo": "Erro no envio de payload",
                                      "route": "route-cobranca-unicred"
                            - to:
                                id: to-5a3c
                                uri: direct
                                parameters:
                                  name: route-trata-erros
                      steps:
                        - setProperty:
                            id: setProperty-5407
                            description: urlRegistroBoleto
                            name: urlRegistroBoleto
                            expression:
                              simple:
                                id: simple-1c7c
                                expression: >-
                                  ${exchangeProperty.bancoURL}/${exchangeProperty.bancoPayloadDados[customAttributes][idBeneficiario]}/titulos
                        - removeHeaders:
                            id: removeHeaders-c018
                            pattern: "*"
                        - setHeaders:
                            id: setHeaders-09b2
                            headers:
                              - id: setHeader-376a
                                name: Authorization
                                expression:
                                  simple:
                                    id: simple-00eb
                                    expression: Bearer ${exchangeProperty.tokenBancario}
                              - id: setHeader-a7a6
                                name: cooperativa
                                expression:
                                  simple:
                                    id: simple-784c
                                    expression: >-
                                      ${exchangeProperty.bancoPayloadDados[customAttributes][cooperativa]}
                              - id: setHeader-403b
                                name: apiKey
                                expression:
                                  simple:
                                    id: simple-5f83
                                    expression: >-
                                      ${exchangeProperty.bancoPayloadDados[appKey]}
                              - id: setHeader-6661
                                name: Content-Type
                                expression:
                                  simple:
                                    id: simple-f6d3
                                    expression: application/json
                        - toD:
                            id: to-b6e3
                            uri: https
                            parameters:
                              bridgeEndpoint: true
                              httpMethod: POST
                              logHttpActivity: false
                              httpUri: ${exchangeProperty.urlRegistroBoleto}
                        - log:
                            id: log-a63e
                            description: "# RECEBEU ID BOLETO UNICRED #"
                            disabled: true
                            message: "# RECEBEU ID BOLETO UNICRED # "
                        - setHeader:
                            id: setHeader-bc0e
                            disabled: false
                            name: Content-Type
                            expression:
                              simple:
                                id: simple-d936
                                expression: application/json
                        - setProperty:
                            id: setProperty-2578
                            description: "Unicred: idBoleto"
                            name: idBoleto
                            expression:
                              simple:
                                id: simple-a3d4
                                expression: ${body}
                        - setBody:
                            id: setBody-f81c
                            disabled: false
                            expression:
                              simple:
                                id: simple-f000
                                expression: "{ \"txId\": \"${body}\" }"
            otherwise:
              id: otherwise-f8e7
              steps:
                - setHeader:
                    id: setHeader-fed2
                    name: CamelHttpResponseCode
                    expression:
                      simple:
                        id: simple-ff12
                        expression: "601"
                - setProperty:
                    id: setProperty-77d6
                    description: "Var: errorRoute"
                    name: errorRoute
                    expression:
                      simple:
                        id: simple-c055
                        expression: >-
                          "mensagem": "Alteração e ou Cancelamentos não são
                          suportados pelo banco Unicred.", "regra": true
                - to:
                    id: to-b677
                    uri: direct
                    parameters:
                      name: route-trata-erros
