- route:
    id: route-cobranca-bb
    nodePrefixId: route-ecf
    from:
      id: from-route-cobranca-bb
      uri: direct
      parameters:
        name: route-cobranca-bb
      steps:
        - log:
            id: log-4a6b
            description: "# ROUTE-route-cobranca-bb #"
            message: "# ROUTE-route-cobranca-bb #"
        - doTry:
            id: doTry-route-cobranca-bb
            doCatch:
              - id: doCatch-route-cobranca-bb
                exception:
                  - java.lang.Exception
                steps:
                  - setHeader:
                      id: setHeader-9309
                      disabled: false
                      name: CamelHttpResponseCode
                      expression:
                        simple:
                          id: simple-ec48
                          expression: "400"
                  - setProperty:
                      id: setProperty-7908
                      description: "Var: errorRoute"
                      name: errorRoute
                      expression:
                        simple:
                          id: simple-b920
                          expression: >-
                            "informativo": "Erro no envio de payload", "route":
                            "route-cobranca-bb"
                  - to:
                      id: to-ea8c
                      uri: direct
                      parameters:
                        name: route-trata-erros
            steps:
              - removeHeaders:
                  id: removeHeaders-d9b0
                  pattern: "*"
              - setHeaders:
                  id: setHeaders-9f41
                  headers:
                    - id: setHeader-2f73
                      disabled: false
                      name: Content-Type
                      expression:
                        simple:
                          id: simple-e000
                          expression: application/json
                    - id: setHeader-2f11
                      name: Authorization
                      expression:
                        simple:
                          id: simple-c988
                          expression: Bearer ${exchangeProperty.tokenBancario}
              - choice:
                  id: choice-6158
                  when:
                    - id: when-3e9d
                      description: Registrar
                      expression:
                        simple:
                          id: simple-aed1
                          expression: ${exchangeProperty.rota[tipo]} == 'registrar'
                      steps:
                        - setProperty:
                            id: setProperty-c32f
                            description: urlRegistroBoleto
                            name: urlRegistroBoleto
                            expression:
                              simple:
                                id: simple-e96b
                                expression: ${exchangeProperty.bancoURL}
                        - log:
                            id: log-ea73
                            description: "# REGISTRO BOLETO BB #"
                            message: "# REGISTRO BOLETO BB # ${body}"
                        - choice:
                            id: choice-6a6f
                            when:
                              - id: when-cf28
                                description: COM CERTIFICDO
                                expression:
                                  simple:
                                    id: simple-2cc6
                                    expression: >-
                                      ${exchangeProperty.securityContext} !=
                                      null &&
                                      ${exchangeProperty.securityContext.trim}
                                      != ''
                                steps:
                                  - toD:
                                      id: to-241b
                                      uri: https
                                      parameters:
                                        httpUri: >-
                                          ${exchangeProperty.urlRegistroBoleto}?gw-dev-app-key=${exchangeProperty.bancoPayloadDados[appKey]}
                                        bridgeEndpoint: true
                                        httpMethod: POST
                                        logHttpActivity: false
                                        sslContextParameters: "#${exchangeProperty.sslBeanId}"
                            otherwise:
                              id: otherwise-19e1
                              steps:
                                - toD:
                                    id: to-b663
                                    uri: https
                                    parameters:
                                      httpUri: >-
                                        ${exchangeProperty.urlRegistroBoleto}?gw-dev-app-key=${exchangeProperty.bancoPayloadDados[appKey]}
                                      bridgeEndpoint: true
                                      httpMethod: POST
                    - id: when-d15a
                      description: Alterar
                      expression:
                        simple:
                          id: simple-2641
                          expression: ${exchangeProperty.rota[tipo]} == 'alterar'
                      steps:
                        - setProperty:
                            id: setProperty-8e34
                            description: urlRegistroBoleto
                            name: urlRegistroBoleto
                            expression:
                              simple:
                                id: simple-e116
                                expression: >-
                                  ${exchangeProperty.bancoURL}/${exchangeProperty.boletoNossoNumero}
                        - log:
                            id: log-5560
                            description: "# ALTERAR BOLETO BB #"
                            message: "# ALTERAR BOLETO BB #"
                        - choice:
                            id: choice-1fc6
                            when:
                              - id: when-5727
                                description: COM CERTIFICADO
                                expression:
                                  simple:
                                    id: simple-616e
                                    expression: >-
                                      ${exchangeProperty.securityContext} !=
                                      null &&
                                      ${exchangeProperty.securityContext.trim}
                                      != ''
                                steps:
                                  - toD:
                                      id: to-45dd
                                      uri: https
                                      parameters:
                                        httpUri: >-
                                          ${exchangeProperty.urlRegistroBoleto}?gw-dev-app-key=${exchangeProperty.bancoPayloadDados[appKey]}
                                        bridgeEndpoint: true
                                        httpMethod: PATCH
                                        logHttpActivity: false
                                        throwExceptionOnFailure: false
                                        sslContextParameters: "#${exchangeProperty.sslBeanId}"
                            otherwise:
                              id: otherwise-36f9
                              steps:
                                - toD:
                                    id: to-be1f
                                    uri: https
                                    parameters:
                                      httpUri: >-
                                        ${exchangeProperty.urlRegistroBoleto}?gw-dev-app-key=${exchangeProperty.bancoPayloadDados[appKey]}
                                      bridgeEndpoint: true
                                      httpMethod: PATCH
                    - id: when-10bc
                      description: Cancelar
                      expression:
                        simple:
                          id: simple-e31d
                          expression: ${exchangeProperty.rota[tipo]} == 'cancelar'
                      steps:
                        - setProperty:
                            id: setProperty-5244
                            description: urlRegistroBoleto
                            name: urlRegistroBoleto
                            expression:
                              simple:
                                id: simple-c113
                                expression: >-
                                  ${exchangeProperty.bancoURL}/${exchangeProperty.boletoNossoNumero}/baixar
                        - log:
                            id: log-b4b1
                            description: "# CANCELAR BOLETO BB #"
                            message: "# CANCELAR BOLETO BB # ${body}"
                        - choice:
                            id: choice-260e
                            when:
                              - id: when-717e
                                description: COM CERTIFICADO
                                expression:
                                  simple:
                                    id: simple-f704
                                    expression: >-
                                      ${exchangeProperty.securityContext} !=
                                      null &&
                                      ${exchangeProperty.securityContext.trim}
                                      != ''
                                steps:
                                  - toD:
                                      id: to-acc8
                                      uri: https
                                      parameters:
                                        httpUri: >-
                                          ${exchangeProperty.urlRegistroBoleto}?gw-dev-app-key=${exchangeProperty.bancoPayloadDados[appKey]}
                                        bridgeEndpoint: true
                                        httpMethod: POST
                                        sslContextParameters: "#${exchangeProperty.sslBeanId}"
                            otherwise:
                              id: otherwise-d2a1
                              steps:
                                - toD:
                                    id: to-8eb2
                                    uri: https
                                    parameters:
                                      httpUri: >-
                                        ${exchangeProperty.urlRegistroBoleto}?gw-dev-app-key=${exchangeProperty.bancoPayloadDados[appKey]}
                                      bridgeEndpoint: true
                                      httpMethod: POST
                  otherwise:
                    id: otherwise-0b3b
                    steps:
                      - setHeader:
                          id: setHeader-f0c3
                          name: CamelHttpResponseCode
                          expression:
                            simple:
                              id: simple-63ca
                              expression: "400"
                      - setProperty:
                          id: setProperty-8095
                          description: "Var: errorRoute"
                          name: errorRoute
                          expression:
                            simple:
                              id: simple-65c9
                              expression: >-
                                "informativo": "Erro no envio de payload",
                                "route": "route-cobranca-bb", "message": "Tipo
                                só pode ser Registrar/Alterar/Cancelar"
                      - to:
                          id: to-ca37
                          uri: direct
                          parameters:
                            name: route-trata-erros
